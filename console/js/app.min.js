!function(){$(".navbar-nav li a").click(function(){$("html, body").animate({scrollTop:0},"slow");var e=$(".navbar-toggle").is(":visible");e&&$(".navbar-collapse").collapse("hide")});var e=angular.module("site",["ngRoute"]);e.controller("PageController",["$scope","$location",function(e,a){this.page=this.title=a.path().substring(1),this.setActive=function(e){this.page=e},this.isActive=function(e){return this.page===e}}]),e.controller("ConsoleController",["$scope","$http","$location",function(e,a,t){var r=this;this.verbMap={GET:"info",PUT:"warning",POST:"success",DELETE:"danger"};var n=t.absUrl();$("#jsonUrl").val(n.substr(0,n.lastIndexOf("/console"))+"/assets/des.json"),this.loadDef=function(e){a.get(e).success(function(e,a,n,s){t.search("api",s.url),r.showDef(e)}).error(function(){r.grabDef()})},this.showDef=function(e){r.apiDef=e,$("#submit_request").unbind("click").click(function(){return r.sendRequest(),!1}),$("#method_list").html(""),$("#method_pulldown").html(""),angular.forEach(e.resources,function(e,a){angular.forEach(e.methods,function(e,t){var n=angular.uppercase(e.verb),s=e.displayName,o=e.description,i=a+"||"+t,l='data-resourceIndex="'+i+'"',p='data-toggle="tooltip" data-placement="auto" title="'+o.replace(/<[^>]+>/gm,"")+'"',u="list-group-item";r.verbMap.hasOwnProperty(n)&&(u+=" list-group-item-"+r.verbMap[n]),$("#method_list").append('<a class="'+u+'" href="#" '+l+" "+p+'><span class="label label-default">'+n+"</span>"+s+"</a>"),$("#method_pulldown").append("<option "+l+' value="'+i+'">'+n+" "+s+"</option>")})}),$('[data-toggle="tooltip"]').tooltip(),$("#method_list a").unbind("click").click(function(){return $("html, body").animate({scrollTop:0},"slow"),r.showMethod($(this).attr("data-resourceIndex")),!1}),$("#method_pulldown").unbind("change").change(function(){r.showMethod($(this).val())})},this.grabDef=function(){var e=t.search().hasOwnProperty("api")?t.search().api:!1;e?r.loadDef(e):$("#notificationModal").modal("show").find("button.js-loadDef").click(function(){r.loadDef($.trim($("#jsonUrl").val()))})}(),this.showMethod=function(e){var a=e.split("||"),t=r.apiDef.resources[a[0]],n=t.methods[a[1]];$("#request_payload, #response_payload").html("");{var s={verb:angular.uppercase(n.verb),name:n.displayName,description:n.description,path:n.path,base:n.baseUrl,parameters:{}};!function(){n.hasOwnProperty("authSchemes")&&null!==n.authSchemes&&angular.forEach(n.authSchemes,function(e){"BASICAUTH"===angular.uppercase(e)&&(s.parameters.authentication={login:{name:"login",dataType:"string"},password:{name:"password",dataType:"password"}})}),angular.forEach([t,n],function(e){e.hasOwnProperty("parameters")&&null!==e.parameters&&angular.forEach(e.parameters,function(e){if(e.hasOwnProperty("type")&&e.hasOwnProperty("name")){var a=angular.lowercase(e.type);s.parameters.hasOwnProperty(a)||(s.parameters[a]={}),s.parameters[a][e.name]=e}}),e.hasOwnProperty("body")&&null!==e.body&&e.body.hasOwnProperty("parameters")&&null!==e.body.parameters&&e.body.parameters.length>0&&(s.parameters.hasOwnProperty("body")||(s.parameters.body={}),angular.forEach(e.body.parameters,function(e){e.hasOwnProperty("name")&&(s.parameters.body[e.name]=e)}))})}(),function(){$("#request_method").text(s.verb).removeClass("info warning success danger"),r.verbMap.hasOwnProperty(s.verb)&&$("#request_method").addClass(r.verbMap[s.verb]),$("#request_url").val(s.path).attr({"data-path":s.path,"data-base":s.base})}(),function(){$("#request_information_tab").html(""),angular.forEach(["base","name","description"],function(e){$("#request_information_tab").append("<dt>"+e+"</dt><dd>"+s[e]+"</dd>")})}(),function(){$("#request_form").html("");var e=["authentication","template","query","header","body"];angular.forEach(s.parameters,function(a,t){-1===$.inArray(t,e)&&e.push(t)}),angular.forEach(e,function(e){if(s.parameters.hasOwnProperty(e)){var a=wrapWithTag(e,"legend"),t=[];angular.forEach(s.parameters[e],function(a,r){var n="request_"+e+"_"+r,s=wrapWithTag(r,"label",{"for":n}),o={name:r,id:n,"class":"form-control",type:"text"};a.hasOwnProperty("dataType")&&null!==a.dataType&&"password"===a.dataType&&(o.type="password"),a.hasOwnProperty("defaultValue")&&null!==a.defaultValue&&a.defaultValue.length>0&&(o.placeholder=o.value=a.defaultValue),a.hasOwnProperty("required")&&a.required===!0&&(o.required=!0),s+=wrapWithTag("","input",o),a.hasOwnProperty("description")&&null!==a.description&&a.description.length>0&&(s+=wrapWithTag(a.description,"p",{"class":"help-block"})),t.push(wrapWithTag(s,"div",{"class":"form-group"}))}),a+=t.join(""),$("#request_form").append(wrapWithTag(a,"fieldset",{"data-paramtype":e}))}})}()}},this.sendRequest=function(){var e={settings:{type:$("#request_method").text(),contentType:"text/plain"}};$('#request_form fieldset[data-paramtype="authentication"] input').length>0&&(e.settings.hasOwnProperty("headers")||(e.settings.headers={}),e.settings.headers.Authorization="Basic "+generateAuth($("#request_authentication_login").val(),$("#request_authentication_password").val())),e.url=$("#request_url").attr("data-base");var a=$("#request_url").attr("data-path");$('#request_form fieldset[data-paramtype="template"] input').each(function(){a=a.split("{"+$(this).attr("name")+"}").join($(this).val())}),e.url+=a;var t={};$('#request_form fieldset[data-paramtype="query"] input').each(function(){t[$(this).attr("name")]=$(this).val()}),e.url=urlEngine.setParams(t,e.url),$('#request_form fieldset[data-paramtype="header"] input').each(function(){e.settings.hasOwnProperty("headers")||(e.settings.headers={}),e.settings.headers[$(this).attr("name")]=$(this).val()});var r={},n=!1;$('#request_form fieldset[data-paramtype="body"] input').each(function(){r[$(this).attr("name")]=$(this).val(),n=!0}),n&&(e.data=JSON.stringify(r));JSON.stringify(e);$("#request_payload").html(cleanJson(JSON.stringify(e))),e.settings.processData=!1,e.settings.success=function(e){$("#response_payload").html(cleanJson(JSON.stringify(e)))},e.settings.error=function(e){$("#response_payload").html(cleanJson(JSON.stringify(e.responseJSON)))},$("#response_tab_trigger").click(),apiEngine.doCall(e)}}]),e.controller("HelpController",function(){}),e.config(["$routeProvider","$locationProvider",function(e,a){e.when("/console",{templateUrl:"partials/console.html",controller:"ConsoleController"}),e.when("/help",{templateUrl:"partials/help.html",controller:"HelpController"}),e.otherwise({redirectTo:"/console"}),a.html5Mode(!0).hashPrefix("!")}])}();