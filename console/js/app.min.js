!function(){$(".navbar-nav li a").click(function(){$("html, body").animate({scrollTop:0},"slow");var e=$(".navbar-toggle").is(":visible");e&&$(".navbar-collapse").collapse("hide")});var e=angular.module("site",["ngRoute"]);e.controller("PageController",["$scope","$location",function(e,a){this.page=this.title=a.path().substring(1),this.setActive=function(e){this.page=e},this.isActive=function(e){return this.page===e}}]),e.controller("ConsoleController",["$scope","$http","$location",function(e,a,t){var r=this;this.verbMap={GET:"info",PUT:"warning",POST:"success",DELETE:"danger"};var o=t.absUrl();$("#jsonUrl").val(o.substr(0,o.lastIndexOf("/console"))+"/assets/des.json"),this.loadDef=function(e){a.get(e).success(function(e,a,o,n){t.search("api",n.url),r.showDef(e)}).error(function(){r.grabDef()})},this.showDef=function(e){r.apiDef=e,$("#submit_request").unbind("click").click(function(){return r.sendRequest(),!1}),$("#method_list").html(""),$("#method_pulldown").html(""),angular.forEach(e.resources,function(e,a){angular.forEach(e.methods,function(e,t){var o=angular.uppercase(e.verb),n=e.displayName,s=e.description,l=a+"||"+t,i='data-resourceIndex="'+l+'"',p='data-toggle="tooltip" data-placement="auto" title="'+s.replace(/<[^>]+>/gm,"")+'"',u="list-group-item";r.verbMap.hasOwnProperty(o)&&(u+=" list-group-item-"+r.verbMap[o]),$("#method_list").append('<a class="'+u+'" href="#" '+i+" "+p+'><span class="label label-default">'+o+"</span>"+n+"</a>"),$("#method_pulldown").append("<option "+i+' value="'+l+'">'+o+" "+n+"</option>")})}),$('[data-toggle="tooltip"]').tooltip(),$("#method_list a").unbind("click").click(function(){return $("html, body").animate({scrollTop:0},"slow"),r.showMethod($(this).attr("data-resourceIndex")),!1}),$("#method_pulldown").unbind("change").change(function(){r.showMethod($(this).val())})},this.grabDef=function(){var e=t.search().hasOwnProperty("api")?t.search().api:!1;e?r.loadDef(e):$("#notificationModal").modal("show").find("button.js-loadDef").click(function(){r.loadDef($.trim($("#jsonUrl").val()))})}(),this.showMethod=function(e){var a=e.split("||"),t=r.apiDef.resources[a[0]],o=t.methods[a[1]];$("#request_payload, #response_payload").html("");{var n={verb:angular.uppercase(o.verb),name:o.displayName,description:o.description,path:o.path,base:o.baseUrl,parameters:{}};!function(){o.hasOwnProperty("authSchemes")&&null!==o.authSchemes&&angular.forEach(o.authSchemes,function(e){"BASICAUTH"===angular.uppercase(e)&&(n.parameters.authentication={login:{name:"login",dataType:"string"},password:{name:"password",dataType:"password"}})}),angular.forEach([t,o],function(e){e.hasOwnProperty("parameters")&&null!==e.parameters&&angular.forEach(e.parameters,function(e){if(e.hasOwnProperty("type")&&e.hasOwnProperty("name")){var a=angular.lowercase(e.type);n.parameters.hasOwnProperty(a)||(n.parameters[a]={}),n.parameters[a][e.name]=e}}),e.hasOwnProperty("body")&&null!==e.body&&e.body.hasOwnProperty("parameters")&&null!==e.body.parameters&&e.body.parameters.length>0&&(n.parameters.hasOwnProperty("body")||(n.parameters.body={}),angular.forEach(e.body.parameters,function(e){e.hasOwnProperty("name")&&(n.parameters.body[e.name]=e)}))})}(),function(){$("#request_method").text(n.verb).removeClass("info warning success danger"),r.verbMap.hasOwnProperty(n.verb)&&$("#request_method").addClass(r.verbMap[n.verb]),$("#request_url").val(n.path).attr({"data-path":n.path,"data-base":n.base})}(),function(){$("#request_information_tab").html(""),angular.forEach(["base","name","description"],function(e){$("#request_information_tab").append("<dt>"+e+"</dt><dd>"+n[e]+"</dd>")})}(),function(){$("#request_form").html("");var e=["authentication","template","query","header","body"];angular.forEach(n.parameters,function(a,t){-1===$.inArray(t,e)&&e.push(t)}),angular.forEach(e,function(e){if(n.parameters.hasOwnProperty(e)){var a=wrapWithTag(e,"legend"),t=[];angular.forEach(n.parameters[e],function(a,r){var o="request_"+e+"_"+r,n=wrapWithTag(r,"label",{"for":o}),s={name:r,id:o,"class":"form-control",type:"text"};a.hasOwnProperty("dataType")&&null!==a.dataType&&"password"===a.dataType&&(s.type="password"),a.hasOwnProperty("defaultValue")&&null!==a.defaultValue&&a.defaultValue.length>0&&(s.placeholder=s.value=a.defaultValue),a.hasOwnProperty("required")&&a.required===!0&&(s.required=!0),n+=wrapWithTag("","input",s),a.hasOwnProperty("description")&&null!==a.description&&a.description.length>0&&(n+=wrapWithTag(a.description,"p",{"class":"help-block"})),t.push(wrapWithTag(n,"div",{"class":"form-group"}))}),a+=t.join(""),$("#request_form").append(wrapWithTag(a,"fieldset",{"data-paramtype":e}))}})}()}},this.sendRequest=function(){var e={settings:{type:$("#request_method").text(),processData:!1,contentType:"application/json",success:function(e,a,t){console.log("success"),console.log(e),console.log(t)},error:function(e){console.log("error"),console.log(e)},complete:function(e){console.log("complete"),console.log(e)}}};$('#request_form fieldset[data-paramtype="authentication"] input').length>0&&(e.settings.hasOwnProperty("headers")||(e.settings.headers={}),e.settings.headers.Authorization="Basic "+generateAuth($("#request_authentication_login").val(),$("#request_authentication_password").val())),e.url=$("#request_url").attr("data-base");var a=$("#request_url").attr("data-path");$('#request_form fieldset[data-paramtype="template"] input').each(function(){a=a.split("{"+$(this).attr("name")+"}").join($(this).val())}),e.url+=a;var t={};$('#request_form fieldset[data-paramtype="query"] input').each(function(){t[$(this).attr("name")]=$(this).val()}),e.url=urlEngine.setParams(t,e.url),$('#request_form fieldset[data-paramtype="header"] input').each(function(){e.settings.hasOwnProperty("headers")||(e.settings.headers={}),e.settings.headers[$(this).attr("name")]=$(this).val()});var r={},o=!1;$('#request_form fieldset[data-paramtype="body"] input').each(function(){r[$(this).attr("name")]=$(this).val(),o=!0}),o&&(e.data=JSON.stringify(r)),apiEngine.doCall(e)}}]),e.controller("HelpController",function(){}),e.config(["$routeProvider","$locationProvider",function(e,a){e.when("/console",{templateUrl:"partials/console.html",controller:"ConsoleController"}),e.when("/help",{templateUrl:"partials/help.html",controller:"HelpController"}),e.otherwise({redirectTo:"/console"}),a.html5Mode(!0).hashPrefix("!")}])}();